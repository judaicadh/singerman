---
import entries from '../../data/items.json';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
    return entries.map(entry => ({
        params: { slug: entry.id }  // use `id` as slug
    }));
}

export async function getStaticProps({ params }) {
    const items = entries.find(entry => entry.id === params.slug);
    if (!items) return { notFound: true };
    return { props: { items } };
}

const { items } = Astro.props;

// ─── Date Formatting ─────────────────────────────────────────
const formatDate = (start, end, fallback) => {
    const startYear = start ? new Date(start * 1000).getUTCFullYear() : null;
    const endYear = end ? new Date(end * 1000).getUTCFullYear() : null;
    if (startYear && endYear && startYear !== endYear) return `${startYear}–${endYear}`;
    return startYear || endYear || fallback || null;
};

const displayDate = formatDate(items.startDate, items.endDate, items.year);
---

<BaseLayout title={items.title}>
    <main class="max-w-5xl mx-auto px-4 py-10 space-y-10">
        <h1 class="text-3xl md:text-4xl font-bold tracking-tight">{items.title}</h1>

        {items.description && (
                <p class="text-lg text-gray-700 dark:text-gray-300">{items.description}</p>
        )}

        <!-- other sections remain unchanged -->
    </main>
</BaseLayout>